<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>STM Group â€” RFQ Configurator</title>
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/docx@8.5.0/build/index.umd.js"></script>
<script>if(typeof docx==='undefined'){document.write('<scr'+'ipt src="https://unpkg.com/docx@8.5.0/build/index.umd.js"><\/scr'+'ipt>')}</script>
<script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
<script>if(typeof saveAs==='undefined'){document.write('<scr'+'ipt src="https://unpkg.com/file-saver@2.0.5/dist/FileSaver.min.js"><\/scr'+'ipt>')}</script>
<style>
:root{--o:#F94816;--oh:#EE4F1E;--ol:#F6BD9A;--obg:rgba(249,72,22,.06);--dk:#22293B;--dk2:#314056;--gr:#CBCFD5;--lt:#EEEEEF;--wh:#FAFAFA;--bd:#3a3f4b;--r:10px;--ss:0 1px 3px rgba(34,41,59,.06);--tr:all .2s cubic-bezier(.4,0,.2,1)}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Outfit',sans-serif;background:var(--lt);color:var(--bd);min-height:100vh;overflow-x:hidden}

.app-header{background:var(--dk);padding:0 32px;height:64px;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:100}
.logo-area{display:flex;align-items:center;gap:16px}
.logo-mark{display:grid;grid-template-columns:repeat(3,8px);grid-template-rows:repeat(3,8px);gap:3px}
.logo-mark span{width:8px;height:8px;background:var(--o);border-radius:1px}
.logo-text{color:#fff;font-weight:700;font-size:18px;letter-spacing:1px}
.logo-text small{color:var(--gr);font-weight:400;font-size:12px;display:block;letter-spacing:.5px;margin-top:-2px}
.header-actions{display:flex;align-items:center;gap:12px}

/* LANG SWITCHER */
.lang-sw{display:flex;background:rgba(255,255,255,.06);border-radius:8px;overflow:hidden;border:1px solid rgba(255,255,255,.08);margin-right:8px}
.lang-btn{padding:7px 14px;font-family:'Outfit',sans-serif;font-size:13px;font-weight:600;cursor:pointer;border:none;background:0 0;color:rgba(255,255,255,.5);transition:var(--tr);display:flex;align-items:center;gap:6px}
.lang-btn:hover{color:rgba(255,255,255,.8);background:rgba(255,255,255,.04)}
.lang-btn.active{color:#fff;background:var(--o)}
.lang-flag{font-size:15px;line-height:1}

.btn{display:inline-flex;align-items:center;gap:8px;padding:10px 20px;border-radius:8px;font-family:'Outfit',sans-serif;font-weight:600;font-size:14px;cursor:pointer;border:none;transition:var(--tr)}
.btn-p{background:var(--o);color:#fff}.btn-p:hover{background:var(--oh);transform:translateY(-1px);box-shadow:0 4px 12px rgba(249,72,22,.3)}
.btn-s{background:var(--dk2);color:#fff;border:1px solid rgba(255,255,255,.1)}.btn-s:hover{background:#3d4d66}

.app-body{display:grid;grid-template-columns:340px 1fr 420px;min-height:calc(100vh - 64px)}

.sidebar-left{background:#fff;border-right:1px solid #e4e5e7;overflow-y:auto;max-height:calc(100vh - 64px);position:sticky;top:64px}
.sidebar-section{padding:20px;border-bottom:1px solid #e4e5e7}
.sidebar-section h3{font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:1.5px;color:var(--dk2);margin-bottom:14px}
.pf{margin-bottom:12px}.pf label{display:block;font-size:12px;font-weight:500;color:#666;margin-bottom:4px}
.pf input,.pf select{width:100%;padding:8px 12px;border:1px solid #ddd;border-radius:6px;font-family:'Outfit',sans-serif;font-size:14px;transition:var(--tr);background:var(--wh)}
.pf input:focus,.pf select:focus{outline:none;border-color:var(--o);box-shadow:0 0 0 3px rgba(249,72,22,.1)}

.block-category{padding:6px 20px 2px}
.block-category-label{font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:1.5px;color:var(--o);margin:12px 0 8px}
.bc{display:flex;align-items:flex-start;gap:10px;padding:10px 14px;margin:0 12px 4px;border-radius:8px;cursor:pointer;transition:var(--tr);border:1px solid transparent}
.bc:hover{background:var(--obg)}.bc.sel{background:var(--obg);border-color:var(--o)}
.bt{width:18px;height:18px;border:2px solid #ccc;border-radius:4px;flex-shrink:0;margin-top:2px;display:flex;align-items:center;justify-content:center;transition:var(--tr)}
.bc.sel .bt{background:var(--o);border-color:var(--o)}.bc.sel .bt::after{content:'âœ“';color:#fff;font-size:11px;font-weight:700}
.bi h4{font-size:13px;font-weight:600;color:var(--dk);line-height:1.3}.bi p{font-size:11px;color:#888;margin-top:2px}
.bb{font-size:9px;font-weight:700;text-transform:uppercase;letter-spacing:.5px;padding:2px 6px;border-radius:4px;background:var(--lt);color:#777;white-space:nowrap;margin-top:3px;flex-shrink:0}
.bc.mand .bb{background:var(--o);color:#fff}

.main-content{padding:28px 32px;overflow-y:auto;max-height:calc(100vh - 64px)}
.main-empty{display:flex;flex-direction:column;align-items:center;justify-content:center;height:60vh;text-align:center;color:#999}
.main-empty .ei{font-size:48px;margin-bottom:16px;opacity:.4}
.main-empty h2{font-size:20px;color:#666;margin-bottom:8px}
.main-empty p{font-size:14px;max-width:320px}
.vs{background:#fff;border-radius:var(--r);padding:24px;margin-bottom:16px;box-shadow:var(--ss);border:1px solid #e8e9eb;animation:fi .3s ease}
@keyframes fi{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
.vsh{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;padding-bottom:12px;border-bottom:2px solid var(--o)}
.vsh h3{font-size:16px;font-weight:700;color:var(--dk)}
.sb{font-size:11px;font-weight:600;padding:4px 10px;border-radius:20px;background:#e8f5e9;color:#2e7d32}.sb.v{background:#fff3e0;color:#e65100}
.vg{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:14px}
.vf label{display:block;font-size:12px;font-weight:500;color:#666;margin-bottom:4px}.vf label .u{color:var(--o);font-weight:600}
.vf input,.vf select{width:100%;padding:9px 12px;border:1px solid #ddd;border-radius:6px;font-family:'Outfit',sans-serif;font-size:14px;transition:var(--tr)}
.vf input:focus,.vf select:focus{outline:none;border-color:var(--o);box-shadow:0 0 0 3px rgba(249,72,22,.1)}
.vf input::placeholder{color:#bbb}
.vf.supplier-set input,.vf.supplier-set select{opacity:.35;pointer-events:none;background:#f5f5f5}
.vf .sup-row{display:flex;align-items:center;justify-content:space-between}
.vf .sup-toggle{display:flex;align-items:center;gap:4px;cursor:pointer;font-size:10px;font-weight:600;text-transform:uppercase;letter-spacing:.5px;color:#aaa;padding:2px 0;user-select:none;transition:var(--tr)}
.vf .sup-toggle:hover{color:var(--o)}
.vf .sup-toggle.active{color:var(--o)}
.vf .sup-toggle .sup-check{width:14px;height:14px;border:1.5px solid #ccc;border-radius:3px;display:flex;align-items:center;justify-content:center;font-size:8px;transition:var(--tr)}
.vf .sup-toggle.active .sup-check{background:var(--o);border-color:var(--o);color:#fff}
.ptx .vs-tag{color:#64b5f6;background:rgba(100,181,246,.12);padding:1px 6px;border-radius:3px;font-style:italic;font-size:12px}

.sidebar-right{background:var(--dk);color:#ddd;overflow-y:auto;max-height:calc(100vh - 64px);position:sticky;top:64px}
.ph{padding:20px 24px 16px;border-bottom:1px solid rgba(255,255,255,.08);display:flex;align-items:center;justify-content:space-between}
.ph h3{font-size:13px;font-weight:700;text-transform:uppercase;letter-spacing:1.5px;color:var(--o)}
.pc{font-size:12px;color:#888}
.pb{padding:20px 24px}
.pbl{margin-bottom:20px;padding-bottom:16px;border-bottom:1px solid rgba(255,255,255,.06);animation:fi .3s ease}.pbl:last-child{border-bottom:none}
.pbt{font-size:12px;font-weight:700;color:var(--o);margin-bottom:6px;text-transform:uppercase;letter-spacing:.5px}
.ptx{font-size:13px;line-height:1.7;color:#c8ccd4;white-space:pre-wrap}
.ptx .vh{color:var(--ol);font-weight:600;background:rgba(249,72,22,.1);padding:1px 4px;border-radius:3px}
.ptx .ve{color:#f94816;background:rgba(249,72,22,.15);padding:1px 6px;border-radius:3px;font-style:italic;font-size:12px}

.status-bar{background:var(--dk);border-top:1px solid rgba(255,255,255,.08);padding:8px 32px;display:flex;align-items:center;justify-content:space-between;font-size:12px;color:#888;position:fixed;bottom:0;left:0;right:0;z-index:100;height:36px}
.status-bar .sl{display:flex;gap:20px}
.sd{width:6px;height:6px;border-radius:50%;background:#4caf50;display:inline-block;margin-right:6px}
@media(max-width:1200px){.app-body{grid-template-columns:300px 1fr}.sidebar-right{display:none}}
::-webkit-scrollbar{width:6px}::-webkit-scrollbar-track{background:0 0}::-webkit-scrollbar-thumb{background:#ccc;border-radius:3px}.sidebar-right::-webkit-scrollbar-thumb{background:#444}
</style>
</head>
<body>
<header class="app-header">
  <div class="logo-area">
    <div class="logo-mark"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></div>
    <div class="logo-text">STM GROUP <small id="ui-sub"></small></div>
  </div>
  <div class="header-actions">
    <div class="lang-sw" id="lang-sw">
      <button class="lang-btn active" data-lang="nl" onclick="setLang('nl')"><span class="lang-flag">ðŸ‡³ðŸ‡±</span> NL</button>
      <button class="lang-btn" data-lang="en" onclick="setLang('en')"><span class="lang-flag">ðŸ‡¬ðŸ‡§</span> EN</button>
      <button class="lang-btn" data-lang="de" onclick="setLang('de')"><span class="lang-flag">ðŸ‡©ðŸ‡ª</span> DE</button>
    </div>
    <button class="btn btn-s" onclick="resetAll()" id="btn-r"></button>
    <button class="btn btn-p" onclick="exportToWord()" id="btn-e"></button>
  </div>
</header>

<div class="app-body">
  <aside class="sidebar-left">
    <div class="sidebar-section">
      <h3 id="ui-pt"></h3>
      <div class="pf"><label id="lbl-pn"></label><input type="text" id="proj-name" oninput="upd()"></div>
      <div class="pf"><label id="lbl-pr"></label><input type="text" id="proj-ref" placeholder="STP25001" oninput="upd()"></div>
      <div class="pf"><label id="lbl-pd"></label><input type="date" id="proj-date" oninput="upd()"></div>
      <div class="pf"><label id="lbl-ps"></label><input type="text" id="proj-supplier" oninput="upd()"></div>
      <div class="pf"><label id="lbl-fw"></label>
        <select id="proj-fw" onchange="upd()"><option value="supply_install" id="o-si"></option><option value="install_only" id="o-io"></option></select>
      </div>
    </div>
    <div class="sidebar-section">
      <h3 id="ui-st"></h3>
      <p style="font-size:12px;color:#999;margin-bottom:12px" id="ui-sh"></p>
    </div>
    <div id="bl"></div>
  </aside>

  <main class="main-content">
    <div class="main-empty" id="es">
      <div class="ei">ðŸ“‹</div>
      <h2 id="ui-et"></h2>
      <p id="ui-eh"></p>
    </div>
    <div id="vf"></div>
  </main>

  <aside class="sidebar-right">
    <div class="ph"><h3 id="ui-pvt"></h3><span class="pc" id="pvc"></span></div>
    <div class="pb" id="pvb"></div>
  </aside>
</div>

<div class="status-bar">
  <div class="sl"><span><span class="sd"></span><span id="ui-sr"></span></span><span id="st-b"></span><span id="st-v"></span></div>
  <span>STM Group â€” RFQ Configurator v2.0</span>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  UI TRANSLATIONS (NL / EN / DE)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const UI = {
nl:{
  sub:'Offerte Configurator â€” PG08 Montage', btnR:'â†» Reset', btnE:'â¬‡ Exporteren naar Word',
  pt:'Projectgegevens', pn:'Projectnaam', pr:'Offertenummer', pd:'Datum', ps:'Leverancier / Geadresseerde', fw:'Zetwerk scope',
  oSI:'Leverancier: Leveren & Monteren zetwerk', oIO:'Leverancier: Alleen monteren (STM levert)',
  st:'Selecteer tekstblokken', sh:'Selecteer blokken voor de aanvraag. Verplichte blokken zijn voorgeselecteerd.',
  et:'Selecteer tekstblokken om te beginnen', eh:'Kies de scope-items uit het linkerpaneel. De variabelen verschijnen hier.',
  pvt:'Live Voorbeeld', pve:'Selecteer blokken om voorbeeld te zien',
  sr:'Gereed', bsel:'blokken geselecteerd', vfil:'variabelen ingevuld', bk:'blokken',
  req:'Verplicht', opt:'Optioneel', sel:'â€” kies â€”',
  io:'Alleen montage', si:'Leveren & Monteren', sv:'Scope varieert âš ',
  dT:'Aanvraag offerte', dS:'Geachte heer/mevrouw,', dI:'Graag ontvangen wij uw prijsopgave voor onderstaande werkzaamheden.',
  dC:'Wij verzoeken u uw prijsopgave per onderdeel te specificeren.', dG:'Met vriendelijke groet,',
  dDt:'Datum', dRf:'Referentie', dPj:'Project', dSu:'Leverancier',
  supBtn:'Leverancier',supFull:'Door leverancier op te geven',supShort:'Lev.'
},
en:{
  sub:'RFQ Configurator â€” PG08 Erection', btnR:'â†» Reset', btnE:'â¬‡ Export to Word',
  pt:'Project Details', pn:'Project Name', pr:'Quote Reference', pd:'Date', ps:'Supplier / Addressee', fw:'Flashwork Scope',
  oSI:'Supplier: Supply & Install flashwork', oIO:'Supplier: Install only (STM supplies)',
  st:'Select Text Blocks', sh:'Toggle blocks to include in the RFQ. Mandatory blocks are pre-selected.',
  et:'Select text blocks to begin', eh:'Choose scope items from the left panel. Variables will appear here.',
  pvt:'Live Preview', pve:'Select blocks to see RFQ preview',
  sr:'Ready', bsel:'blocks selected', vfil:'variables filled', bk:'blocks',
  req:'Required', opt:'Optional', sel:'â€” select â€”',
  io:'Install only', si:'Supply & Install', sv:'Scope varies âš ',
  dT:'Request for Quotation', dS:'Dear Sir/Madam,', dI:'We would like to receive your quotation for the works described below.',
  dC:'Please provide your pricing per scope item.', dG:'Kind regards,',
  dDt:'Date', dRf:'Reference', dPj:'Project', dSu:'Supplier',
  supBtn:'Supplier',supFull:'To be specified by supplier',supShort:'Sup.'
},
de:{
  sub:'Angebotsanfrage â€” PG08 Montage', btnR:'â†» ZurÃ¼cksetzen', btnE:'â¬‡ Export nach Word',
  pt:'Projektdaten', pn:'Projektname', pr:'Angebotsnummer', pd:'Datum', ps:'Lieferant / EmpfÃ¤nger', fw:'Kantteile Umfang',
  oSI:'Lieferant: Liefern & Montieren Kantteile', oIO:'Lieferant: Nur Montage (STM liefert)',
  st:'Textbausteine auswÃ¤hlen', sh:'Bausteine fÃ¼r die Anfrage auswÃ¤hlen. Pflichtbausteine sind vorausgewÃ¤hlt.',
  et:'Textbausteine auswÃ¤hlen', eh:'WÃ¤hlen Sie die Leistungspositionen im linken Panel.',
  pvt:'Live-Vorschau', pve:'Bausteine auswÃ¤hlen fÃ¼r Vorschau',
  sr:'Bereit', bsel:'Bausteine ausgewÃ¤hlt', vfil:'Variablen ausgefÃ¼llt', bk:'Bausteine',
  req:'Pflicht', opt:'Optional', sel:'â€” wÃ¤hlen â€”',
  io:'Nur Montage', si:'Liefern & Montieren', sv:'Umfang variiert âš ',
  dT:'Angebotsanfrage', dS:'Sehr geehrte Damen und Herren,', dI:'Wir bitten um Ihr Angebot fÃ¼r die nachfolgend beschriebenen Leistungen.',
  dC:'Bitte geben Sie Ihre Preise je Leistungsposition an.', dG:'Mit freundlichen GrÃ¼ÃŸen,',
  dDt:'Datum', dRf:'Referenz', dPj:'Projekt', dSu:'Lieferant',
  supBtn:'Lieferant',supFull:'Vom Lieferanten anzugeben',supShort:'Lief.'
}};

const CL = {
nl:{ROOF:'ðŸ—ï¸ Dakbeplating',WALL:'ðŸ§± Gevelbekleding',INTERIOR:'ðŸ  Binnenwanden',EQUIPMENT:'âš™ï¸ Materieel',CONDITIONS:'ðŸ“‹ Uitgangspunten',COMMERCIAL:'ðŸ’° Commercieel'},
en:{ROOF:'ðŸ—ï¸ Roof Cladding',WALL:'ðŸ§± Wall Cladding',INTERIOR:'ðŸ  Interior Walls',EQUIPMENT:'âš™ï¸ Equipment',CONDITIONS:'ðŸ“‹ Conditions',COMMERCIAL:'ðŸ’° Commercial Terms'},
de:{ROOF:'ðŸ—ï¸ Dachverkleidung',WALL:'ðŸ§± Fassadenverkleidung',INTERIOR:'ðŸ  InnenwÃ¤nde',EQUIPMENT:'âš™ï¸ GerÃ¤te',CONDITIONS:'ðŸ“‹ Bedingungen',COMMERCIAL:'ðŸ’° KaufmÃ¤nnisch'}
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  TEXT BLOCKS (trilingual)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const TB = [
{id:'TB-ROOF-01',cat:'ROOF',mand:true,sl:'install_only',
 ti:{nl:'Dakplaten montage',en:'Roof Plate Installation',de:'Dachplatenmontage'},
 ds:{nl:'Montage dakplaten geleverd door STM',en:'Mounting roof plates supplied by STM',de:'Montage der von STM gelieferten Dachplatten'},
 tp:{
  nl:'Montage van de dakplaten door Staalmeesters geleverd.\nCirca {qty_m2} mÂ² sendzimir verzinkte stalen dakplaten.\nType {profile_type}, {thickness_mm} mm dik. Zichtzijde voorzien van {interior_coating}.\nDakplaat is {perforated}.\nBevestiging d.m.v. schietnagels, onderlinge bevestiging d.m.v. teksen h.o.h. {screw_spacing_mm} mm.',
  en:'Installation of roof plates supplied by Staalmeesters.\nApprox. {qty_m2} mÂ² sendzimir galvanised steel roof plates.\nType {profile_type}, {thickness_mm} mm thick. Visible side with {interior_coating}.\nRoof plate is {perforated}.\nFastening by shot nails, lateral fastening by self-tapping screws c/c {screw_spacing_mm} mm.',
  de:'Montage der von Staalmeesters gelieferten Dachplatten.\nCa. {qty_m2} mÂ² sendzimir-verzinkte Stahldachplatten.\nTyp {profile_type}, {thickness_mm} mm dick. Sichtseite mit {interior_coating}.\nDachplatte ist {perforated}.\nBefestigung mittels SchussnÃ¤geln, LÃ¤ngsbefestigung durch Bohrschrauben Abstand {screw_spacing_mm} mm.'
 },
 vars:[
  {n:'qty_m2',l:{nl:'Dakoppervlak',en:'Roof area',de:'DachflÃ¤che'},u:'mÂ²',t:'number',ph:'960'},
  {n:'profile_type',l:{nl:'Profieltype',en:'Profile type',de:'Profiltyp'},u:'',t:'select',opts:['SAB 135R/930','SAB 106R/1060','SAB 85R/1142']},
  {n:'thickness_mm',l:{nl:'Staaldikte',en:'Steel thickness',de:'Stahldicke'},u:'mm',t:'number',ph:'0.88'},
  {n:'interior_coating',l:{nl:'Interieurcoating',en:'Interior coating',de:'Innenbeschichtung'},u:'',t:'text',ph:'interieurcoating'},
  {n:'perforated',l:{nl:'Geperforeerd?',en:'Perforated?',de:'Perforiert?'},u:'',t:'select',opts:['niet geperforeerd','geperforeerd']},
  {n:'screw_spacing_mm',l:{nl:'Schroefafstand',en:'Screw spacing',de:'Schraubenabstand'},u:'mm',t:'number',ph:'500'},
]},
{id:'TB-ROOF-02',cat:'ROOF',mand:true,sl:'varies',
 ti:{nl:'Mastiekhoeken',en:'Mastic Angles',de:'Mastixwinkel'},
 ds:{nl:'Nok-/goot afdichtstroken',en:'Ridge/eave sealing strips',de:'First-/Traufabdichtungen'},
 tp:{
  nl:'Circa {qty_m1} mÂ¹ sendzimir verzinkte stalen mastiekhoeken, max. ontw. breedte {width_mm} mm, {thickness_mm} mm dik.',
  en:'Approx. {qty_m1} mÂ¹ sendzimir galvanised steel mastic angles, max. dev. width {width_mm} mm, {thickness_mm} mm thick.',
  de:'Ca. {qty_m1} mÂ¹ sendzimir-verzinkte Stahl-Mastixwinkel, max. abg. Breite {width_mm} mm, {thickness_mm} mm dick.'
 },
 vars:[
  {n:'qty_m1',l:{nl:'Lengte',en:'Length',de:'LÃ¤nge'},u:'mÂ¹',t:'number',ph:'128'},
  {n:'width_mm',l:{nl:'Ontw. breedte',en:'Dev. width',de:'Abg. Breite'},u:'mm',t:'number',ph:'250'},
  {n:'thickness_mm',l:{nl:'Dikte',en:'Thickness',de:'Dicke'},u:'mm',t:'number',ph:'0.75'},
]},
{id:'TB-ROOF-03',cat:'ROOF',mand:true,sl:'supply_install',
 ti:{nl:'Veiligheidsvoorzieningen',en:'Safety Equipment',de:'Sicherheitseinrichtungen'},
 ds:{nl:'Veiligheidsnetten & randbeveiliging',en:'Safety nets & edge protection',de:'Sicherheitsnetze & Randsicherung'},
 tp:{
  nl:'Inclusief veiligheidsvoorzieningen:\nCirca {nets_m2} mÂ² veiligheidsnetten, huurprijs max. {nets_days} werkdagen.\nCirca {edge_m1} mÂ¹ randbeveiliging, huurprijs max. {edge_days} werkdagen.',
  en:'Including safety provisions:\nApprox. {nets_m2} mÂ² safety nets, rental max. {nets_days} working days.\nApprox. {edge_m1} mÂ¹ edge protection, rental max. {edge_days} working days.',
  de:'Inklusive Sicherheitseinrichtungen:\nCa. {nets_m2} mÂ² Sicherheitsnetze, Miete max. {nets_days} Arbeitstage.\nCa. {edge_m1} mÂ¹ Randsicherung, Miete max. {edge_days} Arbeitstage.'
 },
 vars:[
  {n:'nets_m2',l:{nl:'Netten oppervlak',en:'Safety nets area',de:'NetzflÃ¤che'},u:'mÂ²',t:'number',ph:'960'},
  {n:'nets_days',l:{nl:'Huurperiode netten',en:'Nets rental',de:'Mietdauer Netze'},u:{nl:'dagen',en:'days',de:'Tage'},t:'number',ph:'15'},
  {n:'edge_m1',l:{nl:'Randbeveiliging',en:'Edge protection',de:'Randsicherung'},u:'mÂ¹',t:'number',ph:'130'},
  {n:'edge_days',l:{nl:'Huurperiode rand',en:'Edge rental',de:'Mietdauer Rand'},u:{nl:'dagen',en:'days',de:'Tage'},t:'number',ph:'25'},
]},
{id:'TB-WALL-01',cat:'WALL',mand:true,sl:'install_only',
 ti:{nl:'Sandwichpanelen montage',en:'Sandwich Panel Installation',de:'Sandwichplattenmontage'},
 ds:{nl:'Montage geÃ¯soleerde gevelpanelen',en:'Mounting insulated wall panels',de:'Montage isolierter Wandpaneele'},
 tp:{
  nl:'Het monteren van circa {qty_m2} mÂ² sendzimir verzinkte geÃ¯soleerde gevelpanelen.\n{orientation} gemonteerd, type {panel_type}, {fastening}.\nDikte: {thickness_mm} mm. Werkende breedte: {working_width_mm} mm.\nBuitenplaat: {outer_thickness_mm} mm, {outer_coating} RAL {ral_outer}, profilering {profile_outer}.\nBinnenplaat: {inner_thickness_mm} mm, {inner_coating}, profilering {profile_inner}.\nKern: {core_type}.',
  en:'Installation of approx. {qty_m2} mÂ² sendzimir galvanised insulated facade panels.\nMounted {orientation}, type {panel_type}, {fastening}.\nThickness: {thickness_mm} mm. Working width: {working_width_mm} mm.\nOuter sheet: {outer_thickness_mm} mm, {outer_coating} RAL {ral_outer}, profile {profile_outer}.\nInner sheet: {inner_thickness_mm} mm, {inner_coating}, profile {profile_inner}.\nCore: {core_type}.',
  de:'Montage von ca. {qty_m2} mÂ² sendzimir-verzinkten Sandwich-Fassadenpaneelen.\n{orientation} montiert, Typ {panel_type}, {fastening}.\nDicke: {thickness_mm} mm. Wirkbreite: {working_width_mm} mm.\nAuÃŸenblech: {outer_thickness_mm} mm, {outer_coating} RAL {ral_outer}, Profilierung {profile_outer}.\nInnenblech: {inner_thickness_mm} mm, {inner_coating}, Profilierung {profile_inner}.\nKern: {core_type}.'
 },
 vars:[
  {n:'qty_m2',l:{nl:'Geveloppervlak',en:'Wall area',de:'WandflÃ¤che'},u:'mÂ²',t:'number',ph:'1001'},
  {n:'orientation',l:{nl:'OriÃ«ntatie',en:'Orientation',de:'Ausrichtung'},u:'',t:'select',opts:['Verticaal','Horizontaal']},
  {n:'panel_type',l:{nl:'Paneeltype',en:'Panel type',de:'Paneeltyp'},u:'',t:'text',ph:'Vlak Cladding point'},
  {n:'fastening',l:{nl:'Bevestiging',en:'Fastening',de:'Befestigung'},u:'',t:'select',opts:['verdekt geschroefd','zichtbaar geschroefd']},
  {n:'thickness_mm',l:{nl:'Paneeldikte',en:'Panel thickness',de:'Paneeldicke'},u:'mm',t:'number',ph:'100'},
  {n:'working_width_mm',l:{nl:'Werkende breedte',en:'Working width',de:'Wirkbreite'},u:'mm',t:'number',ph:'1000'},
  {n:'outer_thickness_mm',l:{nl:'Buitenplaat',en:'Outer steel',de:'AuÃŸenblech'},u:'mm',t:'number',ph:'0.60'},
  {n:'outer_coating',l:{nl:'Coating buiten',en:'Outer coating',de:'AuÃŸenbeschichtung'},u:'',t:'select',opts:['HDX','Polyester','Diamond']},
  {n:'ral_outer',l:{nl:'RAL buiten',en:'RAL outer',de:'RAL auÃŸen'},u:'',t:'text',ph:'9016'},
  {n:'profile_outer',l:{nl:'Profiel buiten',en:'Profile outer',de:'Profil auÃŸen'},u:'',t:'select',opts:['vlak','Micro lining MR15','Box LL']},
  {n:'inner_thickness_mm',l:{nl:'Binnenplaat',en:'Inner steel',de:'Innenblech'},u:'mm',t:'number',ph:'0.50'},
  {n:'inner_coating',l:{nl:'Coating binnen',en:'Inner coating',de:'Innenbeschichtung'},u:'',t:'text',ph:'interieurcoating 15 mu RAL 9002'},
  {n:'profile_inner',l:{nl:'Profiel binnen',en:'Profile inner',de:'Profil innen'},u:'',t:'select',opts:['Box LL','Micro lining','vlak']},
  {n:'core_type',l:{nl:'Kernmateriaal',en:'Core material',de:'Kernmaterial'},u:'',t:'select',opts:['Standaard PIR','PUR','Mineral Wool']},
]},
{id:'TB-WALL-02',cat:'WALL',mand:true,sl:'varies',
 ti:{nl:'Steldorpel / Onderdorpel',en:'Base Profile / Carrier',de:'FuÃŸprofil'},
 ds:{nl:'Draagprofiel onderzijde gevel',en:'Panel base/carrier profile',de:'FuÃŸprofil unter Fassade'},
 tp:{nl:'Circa {qty_m1} mÂ¹ steldorpel/onderdorpel, {thickness_mm} mm, max. ontw. breedte {width_mm} mm.',en:'Approx. {qty_m1} mÂ¹ base profile, {thickness_mm} mm, max. dev. width {width_mm} mm.',de:'Ca. {qty_m1} mÂ¹ FuÃŸprofil, {thickness_mm} mm, max. abg. Breite {width_mm} mm.'},
 vars:[{n:'qty_m1',l:{nl:'Lengte',en:'Length',de:'LÃ¤nge'},u:'mÂ¹',t:'number',ph:'148'},{n:'width_mm',l:{nl:'Ontw. breedte',en:'Dev. width',de:'Abg. Breite'},u:'mm',t:'number',ph:'280'},{n:'thickness_mm',l:{nl:'Dikte',en:'Thickness',de:'Dicke'},u:'mm',t:'number',ph:'0.75'}]},
{id:'TB-WALL-03',cat:'WALL',mand:true,sl:'varies',
 ti:{nl:'Overzetdorpels',en:'Drip Profiles',de:'Abdeckprofile'},
 ds:{nl:'Afdekprofielen over onderdorpel',en:'Cover/drip flashings',de:'Abdeckprofile'},
 tp:{nl:'Circa {qty_m1} mÂ¹ overzetdorpels, max. ontw. breedte {width_mm} mm, {thickness_mm} mm dik, voorzien van {coating} coating in kleur als buitenzijde.',en:'Approx. {qty_m1} mÂ¹ drip profiles, max. dev. width {width_mm} mm, {thickness_mm} mm thick, {coating} coating matching facade colour.',de:'Ca. {qty_m1} mÂ¹ Abdeckprofile, max. abg. Breite {width_mm} mm, {thickness_mm} mm dick, {coating}-Beschichtung farblich passend.'},
 vars:[{n:'qty_m1',l:{nl:'Lengte',en:'Length',de:'LÃ¤nge'},u:'mÂ¹',t:'number',ph:'148'},{n:'width_mm',l:{nl:'Ontw. breedte',en:'Dev. width',de:'Abg. Breite'},u:'mm',t:'number',ph:'140'},{n:'thickness_mm',l:{nl:'Dikte',en:'Thickness',de:'Dicke'},u:'mm',t:'number',ph:'0.63'},{n:'coating',l:{nl:'Coating',en:'Coating',de:'Beschichtung'},u:'',t:'select',opts:['HDX','Polyester','Diamond']}]},
{id:'TB-WALL-04',cat:'WALL',mand:true,sl:'varies',
 ti:{nl:'Dakkappen / Afdekkappen',en:'Roof Edge Caps',de:'Dachrandkappen'},
 ds:{nl:'Afdekprofielen dakrand',en:'Capping at roof edge',de:'Abdeckung Dachkante'},
 tp:{nl:'Circa {qty_m1} mÂ¹ afdekkappen als dakrand, max. ontw. breedte {width_mm} mm, voorzien van {coating} coating, kleur als panelen.',en:'Approx. {qty_m1} mÂ¹ roof edge caps, max. dev. width {width_mm} mm, {coating} coating matching panels.',de:'Ca. {qty_m1} mÂ¹ Dachrandkappen, max. abg. Breite {width_mm} mm, {coating}-Beschichtung farblich passend.'},
 vars:[{n:'qty_m1',l:{nl:'Lengte',en:'Length',de:'LÃ¤nge'},u:'mÂ¹',t:'number',ph:'121'},{n:'width_mm',l:{nl:'Ontw. breedte',en:'Dev. width',de:'Abg. Breite'},u:'mm',t:'number',ph:'350'},{n:'coating',l:{nl:'Coating',en:'Coating',de:'Beschichtung'},u:'',t:'select',opts:['HDX','Polyester','Diamond']}]},
{id:'TB-WALL-05',cat:'WALL',mand:true,sl:'varies',
 ti:{nl:'U-profiel dakrand',en:'U-Profile Roof Edge',de:'U-Profil Dachrand'},
 ds:{nl:'U-profiel paneelafdekker',en:'U-profile panel cover',de:'U-Profil Paneelabdeckung'},
 tp:{nl:'Circa {qty_m1} mÂ¹ U-profiel (paneel afdekker), max. ontw. breedte {width_mm} mm, {thickness_mm} mm dik.',en:'Approx. {qty_m1} mÂ¹ U-profile (panel cover), max. dev. width {width_mm} mm, {thickness_mm} mm thick.',de:'Ca. {qty_m1} mÂ¹ U-Profil (Paneelabdeckung), max. abg. Breite {width_mm} mm, {thickness_mm} mm dick.'},
 vars:[{n:'qty_m1',l:{nl:'Lengte',en:'Length',de:'LÃ¤nge'},u:'mÂ¹',t:'number',ph:'121'},{n:'width_mm',l:{nl:'Ontw. breedte',en:'Dev. width',de:'Abg. Breite'},u:'mm',t:'number',ph:'260'},{n:'thickness_mm',l:{nl:'Dikte',en:'Thickness',de:'Dicke'},u:'mm',t:'number',ph:'0.75'}]},
{id:'TB-WALL-06',cat:'WALL',mand:true,sl:'varies',
 ti:{nl:'Hoekstukken',en:'Corner Pieces',de:'EckstÃ¼cke'},
 ds:{nl:'Buiten- en binnenhoekprofielen',en:'External & internal corners',de:'AuÃŸen- und Innenecken'},
 tp:{nl:'Circa {qty_outer_m1} mÂ¹ hoekstukken buiten, ontw. breedte {width_outer_mm} mm, {coating} coating.\nCirca {qty_inner_m1} mÂ¹ hoekstukken binnen, ontw. breedte {width_inner_mm} mm.',en:'Approx. {qty_outer_m1} mÂ¹ external corners, dev. width {width_outer_mm} mm, {coating} coating.\nApprox. {qty_inner_m1} mÂ¹ internal corners, dev. width {width_inner_mm} mm.',de:'Ca. {qty_outer_m1} mÂ¹ AuÃŸenecken, abg. Breite {width_outer_mm} mm, {coating}-Beschichtung.\nCa. {qty_inner_m1} mÂ¹ Innenecken, abg. Breite {width_inner_mm} mm.'},
 vars:[{n:'qty_outer_m1',l:{nl:'Buitenhoeken',en:'Ext. corners',de:'AuÃŸenecken'},u:'mÂ¹',t:'number',ph:'48'},{n:'width_outer_mm',l:{nl:'Breedte buiten',en:'Width outer',de:'Breite auÃŸen'},u:'mm',t:'number',ph:'500'},{n:'qty_inner_m1',l:{nl:'Binnenhoeken',en:'Int. corners',de:'Innenecken'},u:'mÂ¹',t:'number',ph:'48'},{n:'width_inner_mm',l:{nl:'Breedte binnen',en:'Width inner',de:'Breite innen'},u:'mm',t:'number',ph:'400'},{n:'coating',l:{nl:'Coating',en:'Coating',de:'Beschichtung'},u:'',t:'select',opts:['HDX','Polyester','Diamond']}]},
{id:'TB-WALL-07',cat:'WALL',mand:false,sl:'varies',
 ti:{nl:'Dagkanten kozijnen',en:'Window/Door Reveals',de:'Fensterleibungen'},
 ds:{nl:'Zetwerk rondom kozijnen',en:'Flashwork around openings',de:'Kantteile um Ã–ffnungen'},
 tp:{nl:'Circa {qty_reveal_m1} mÂ¹ dagkant kozijnen, ontw. {width_reveal_mm} mm.\nCirca {qty_ceiling_m1} mÂ¹ plafondplaat kozijnen, ontw. {width_ceiling_mm} mm.\nCirca {qty_drip_m1} mÂ¹ lekdorpels boven kozijnen, ontw. {width_drip_mm} mm.',en:'Approx. {qty_reveal_m1} mÂ¹ window reveals, dev. {width_reveal_mm} mm.\nApprox. {qty_ceiling_m1} mÂ¹ soffit plates, dev. {width_ceiling_mm} mm.\nApprox. {qty_drip_m1} mÂ¹ drip profiles above openings, dev. {width_drip_mm} mm.',de:'Ca. {qty_reveal_m1} mÂ¹ Fensterleibungen, abg. {width_reveal_mm} mm.\nCa. {qty_ceiling_m1} mÂ¹ Deckenplatten, abg. {width_ceiling_mm} mm.\nCa. {qty_drip_m1} mÂ¹ Tropfprofile Ã¼ber Ã–ffnungen, abg. {width_drip_mm} mm.'},
 vars:[{n:'qty_reveal_m1',l:{nl:'Dagkanten',en:'Reveals',de:'Leibungen'},u:'mÂ¹',t:'number',ph:'40'},{n:'width_reveal_mm',l:{nl:'Breedte',en:'Width',de:'Breite'},u:'mm',t:'number',ph:'250'},{n:'qty_ceiling_m1',l:{nl:'Plafondplaten',en:'Soffit plates',de:'Deckenplatten'},u:'mÂ¹',t:'number',ph:'38'},{n:'width_ceiling_mm',l:{nl:'Breedte',en:'Width',de:'Breite'},u:'mm',t:'number',ph:'150'},{n:'qty_drip_m1',l:{nl:'Lekdorpels',en:'Drip profiles',de:'Tropfprofile'},u:'mÂ¹',t:'number',ph:'38'},{n:'width_drip_mm',l:{nl:'Breedte',en:'Width',de:'Breite'},u:'mm',t:'number',ph:'150'}]},
{id:'TB-WALL-08',cat:'WALL',mand:false,sl:'varies',
 ti:{nl:'Dagkanten overheaddeur',en:'Overhead Door Reveals',de:'Sektionaltorleibungen'},
 ds:{nl:'Zetwerk rondom overheaddeuren',en:'Flashwork around overhead doors',de:'Kantteile um Sektionaltore'},
 tp:{nl:'Circa {qty_side_m1} mÂ¹ dagkant overheaddeur, ontw. {width_side_mm} mm.\nCirca {qty_ceiling_m1} mÂ¹ plafondplaat overheaddeur, ontw. {width_ceiling_mm} mm.',en:'Approx. {qty_side_m1} mÂ¹ overhead door reveals, dev. {width_side_mm} mm.\nApprox. {qty_ceiling_m1} mÂ¹ overhead door soffit, dev. {width_ceiling_mm} mm.',de:'Ca. {qty_side_m1} mÂ¹ Sektionaltorleibungen, abg. {width_side_mm} mm.\nCa. {qty_ceiling_m1} mÂ¹ Deckenplatten Sektionaltor, abg. {width_ceiling_mm} mm.'},
 vars:[{n:'qty_side_m1',l:{nl:'Dagkanten',en:'Side reveals',de:'Seitenleibungen'},u:'mÂ¹',t:'number',ph:'8.5'},{n:'width_side_mm',l:{nl:'Breedte',en:'Width',de:'Breite'},u:'mm',t:'number',ph:'500'},{n:'qty_ceiling_m1',l:{nl:'Plafondplaten',en:'Soffit plates',de:'Deckenplatten'},u:'mÂ¹',t:'number',ph:'4'},{n:'width_ceiling_mm',l:{nl:'Breedte',en:'Width',de:'Breite'},u:'mm',t:'number',ph:'400'}]},
{id:'TB-INT-01',cat:'INTERIOR',mand:false,sl:'install_only',
 ti:{nl:'Binnenwanden',en:'Interior Walls',de:'InnenwÃ¤nde'},
 ds:{nl:'Binnenwandpanelen door STM geleverd',en:'Interior panels supplied by STM',de:'Innenwandpaneele von STM geliefert'},
 tp:{nl:'Montage circa {qty_m2} mÂ² binnenwandpanelen, incl. materieel en bevestigingsmiddelen.\n{cannelurevulling}.\nZetwerk: circa {u_profile_m1} mÂ¹ U-profiel, ontw. {u_width_mm} mm.\nCirca {corner_m1} mÂ¹ hoeklijnen, ontw. {corner_width_mm} mm.',en:'Installation of approx. {qty_m2} mÂ² interior wall panels, incl. equipment and fasteners.\n{cannelurevulling}.\nFlashwork: approx. {u_profile_m1} mÂ¹ U-profile, dev. {u_width_mm} mm.\nApprox. {corner_m1} mÂ¹ corner profiles, dev. {corner_width_mm} mm.',de:'Montage ca. {qty_m2} mÂ² Innenwandpaneele, inkl. GerÃ¤te und Befestigungsmittel.\n{cannelurevulling}.\nKantteile: ca. {u_profile_m1} mÂ¹ U-Profil, abg. {u_width_mm} mm.\nCa. {corner_m1} mÂ¹ Eckprofile, abg. {corner_width_mm} mm.'},
 vars:[{n:'qty_m2',l:{nl:'Oppervlak',en:'Area',de:'FlÃ¤che'},u:'mÂ²',t:'number',ph:'250'},{n:'cannelurevulling',l:{nl:'Cannelurevulling',en:'Cannelure filling',de:'SickenausfÃ¼llung'},u:'',t:'select',opts:['Inclusief cannelurevulling','Exclusief cannelurevulling']},{n:'u_profile_m1',l:{nl:'U-profiel',en:'U-profile',de:'U-Profil'},u:'mÂ¹',t:'number',ph:'36'},{n:'u_width_mm',l:{nl:'Breedte',en:'Width',de:'Breite'},u:'mm',t:'number',ph:'190'},{n:'corner_m1',l:{nl:'Hoeklijnen',en:'Corner profiles',de:'Eckprofile'},u:'mÂ¹',t:'number',ph:'38'},{n:'corner_width_mm',l:{nl:'Breedte',en:'Width',de:'Breite'},u:'mm',t:'number',ph:'120'}]},
{id:'TB-EQUIP-01',cat:'EQUIPMENT',mand:true,sl:'supply_install',
 ti:{nl:'Materieel & Toegang',en:'Equipment & Access',de:'GerÃ¤te & Zugang'},
 ds:{nl:'Kraan, hoogwerker, zuignap',en:'Cranes, platforms, suction',de:'Kran, HebebÃ¼hne, Saugnapf'},
 tp:{nl:'Inclusief kraan ({crane_type}) voor montage en lossen, incl. zuignap/hijstangen.\nInclusief klimmateriaal ({platform_type}).\nInclusief bevestigingsmateriaal en zaagwerk.',en:'Including crane ({crane_type}) for installation and unloading, incl. suction cups/lifting beams.\nIncluding access equipment ({platform_type}).\nIncluding fasteners and sawing work.',de:'Inklusive Kran ({crane_type}) fÃ¼r Montage und Entladung, inkl. SaugnÃ¤pfe/Hebegeschirr.\nInklusive Zugangstechnik ({platform_type}).\nInklusive Befestigungsmaterial und SÃ¤gearbeiten.'},
 vars:[{n:'crane_type',l:{nl:'Kraantype',en:'Crane type',de:'Krantyp'},u:'',t:'text',ph:'33m torenkraan'},{n:'platform_type',l:{nl:'Hoogwerker',en:'Access platform',de:'HebebÃ¼hne'},u:'',t:'text',ph:'telescoophoogwerker 12m'}]},
{id:'TB-COND-01',cat:'CONDITIONS',mand:true,sl:'n/a',
 ti:{nl:'Uitgangspunten',en:'Site Conditions',de:'Baustellenbedingungen'},
 ds:{nl:'Standaard uitgangspunten',en:'Standard assumptions',de:'Standardannahmen'},
 tp:{nl:'Uitgangspunten:\n- Montage in {work_phases} aaneengesloten periode(n). Onderbrekingen worden doorberekend.\n- Montage op vlakke (staal)constructie. Niet door ons op afwijkingen gecontroleerd.\n- Terrein rondom voldoende breed, verhard en vrij van obstakels.\n- Rijplaten door en voor rekening van opdrachtgever.\n- Stroom gratis binnen 30 meter.\n- Schaftkeet en sanitair door opdrachtgever.\n- Tussentijds niet afgedekt (weerrisico opdrachtgever).\n- CAR verzekering afgesloten door opdrachtgever.',en:'Site conditions:\n- Work in {work_phases} continuous period(s). Interruptions charged separately.\n- Installation on flat steel structure. Not checked for deviations.\n- Sufficient access around site, hardened and obstacle-free.\n- Trackway mats at client\'s expense.\n- Power supply free within 30m radius.\n- Welfare facilities by client.\n- No interim covering (weather risk with client).\n- Client has comprehensive CAR insurance.',de:'Baustellenbedingungen:\n- AusfÃ¼hrung in {work_phases} zusammenhÃ¤ngenden Periode(n). Unterbrechungen werden berechnet.\n- Montage auf ebener Stahlkonstruktion. Nicht auf Abweichungen geprÃ¼ft.\n- Ausreichend Zugang, befestigt und hindernisfrei.\n- Fahrplatten auf Kosten des Auftraggebers.\n- Strom kostenlos im Umkreis von 30m.\n- Baustelleneinrichtung durch Auftraggeber.\n- Keine Zwischenabdeckung (Witterungsrisiko Auftraggeber).\n- CAR-Versicherung durch Auftraggeber abgeschlossen.'},
 vars:[{n:'work_phases',l:{nl:'Werkfasen',en:'Work phases',de:'Arbeitsphasen'},u:'',t:'select',opts:['Ã©Ã©n','meerdere']}]},
{id:'TB-COND-02',cat:'CONDITIONS',mand:true,sl:'n/a',
 ti:{nl:'Uitsluitingen',en:'Exclusions',de:'AusschlÃ¼sse'},
 ds:{nl:'Niet inbegrepen',en:'Excluded items',de:'Nicht enthalten'},
 tp:{nl:'Niet in onze prijs opgenomen:\nâ€¢ Cannelurevulling kopse kanten dakplaten\nâ€¢ Afdichtingsband tussen panelen en constructie\nâ€¢ Schoonmaken vervuiling door slechte omstandigheden\nâ€¢ Afvoeren verpakkings-/afvalmateriaal (opdrachtgever zorgt voor container)\nâ€¢ Leveren PVC noodoversstort\nâ€¢ Constructieve berekeningen en tekenwerk\nâ€¢ Demontage/sloopwerk\nâ€¢ Sparingen >250mm dienen volledig ondersteund (raveling)',en:'Not included in our price:\nâ€¢ Cannelure filling at ridge ends\nâ€¢ Sealing tape between panels and substructure\nâ€¢ Cleaning contamination from poor site conditions\nâ€¢ Waste removal (client provides container)\nâ€¢ Supply of PVC emergency overflow\nâ€¢ Structural calculations and drawings\nâ€¢ Demolition/dismantling work\nâ€¢ Openings >250mm must be fully trimmed',de:'Nicht im Preis enthalten:\nâ€¢ SickenausfÃ¼llung an Stirnseiten\nâ€¢ Dichtungsband zwischen Paneelen und Konstruktion\nâ€¢ Reinigung bei schlechten Baustellenbedingungen\nâ€¢ Abfallentsorgung (Auftraggeber stellt Container)\nâ€¢ PVC-NotÃ¼berlauf\nâ€¢ Statik und Zeichenarbeit\nâ€¢ Demontage-/Abrissarbeiten\nâ€¢ Ã–ffnungen >250mm mÃ¼ssen allseitig unterstÃ¼tzt sein'},
 vars:[]},
{id:'TB-COMM-01',cat:'COMMERCIAL',mand:true,sl:'n/a',
 ti:{nl:'Prijs- en leveringscondities',en:'Commercial Terms',de:'KaufmÃ¤nnische Bedingungen'},
 ds:{nl:'Betalingsvoorwaarden, geldigheid',en:'Payment terms, validity',de:'Zahlungsbedingungen, GÃ¼ltigkeit'},
 tp:{nl:'Prijs- en leveringscondities:\n- Prijzen {validity_days} dagen geldig.\n- Ongedeelde opdracht.\n- Exclusief BTW.\n- Levertijd: ca. {lead_time} weken na opdracht.\n- Materiaalprijsstijgingen worden doorberekend.\n\nBetalingstermijnen:\n- {term_1_pct}% bij opdracht\n- Na rato van werkzaamheden\n- {term_final_pct}% bij oplevering\n\nNetto binnen 14 dagen na factuurdatum.',en:'Commercial terms:\n- Prices valid {validity_days} days.\n- Undivided order.\n- Excluding VAT.\n- Lead time: approx. {lead_time} weeks after order.\n- Material price increases passed on.\n\nPayment terms:\n- {term_1_pct}% upon order\n- Pro rata on progress\n- {term_final_pct}% upon completion\n\nNet within 14 days of invoice date.',de:'KaufmÃ¤nnische Bedingungen:\n- Preise {validity_days} Tage gÃ¼ltig.\n- Ungeteilter Auftrag.\n- Ohne MwSt.\n- Lieferzeit: ca. {lead_time} Wochen nach Auftrag.\n- MaterialpreiserhÃ¶hungen werden weitergegeben.\n\nZahlungsbedingungen:\n- {term_1_pct}% bei Auftragserteilung\n- Anteilig nach Fortschritt\n- {term_final_pct}% bei Fertigstellung\n\nNetto innerhalb 14 Tagen nach Rechnungsdatum.'},
 vars:[{n:'validity_days',l:{nl:'Geldigheid',en:'Validity',de:'GÃ¼ltigkeit'},u:{nl:'dagen',en:'days',de:'Tage'},t:'number',ph:'14'},{n:'lead_time',l:{nl:'Levertijd',en:'Lead time',de:'Lieferzeit'},u:{nl:'weken',en:'weeks',de:'Wochen'},t:'text',ph:'6-8'},{n:'term_1_pct',l:{nl:'Eerste termijn',en:'First payment',de:'Erste Rate'},u:'%',t:'number',ph:'10'},{n:'term_final_pct',l:{nl:'Laatste termijn',en:'Final payment',de:'Letzte Rate'},u:'%',t:'number',ph:'10'}]},
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  STATE & HELPERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const S={sel:new Set(),vals:{},supVars:{},lang:'nl'};
const CO=['ROOF','WALL','INTERIOR','EQUIPMENT','CONDITIONS','COMMERCIAL'];
const t=k=>UI[S.lang]?.[k]||UI.en[k]||k;
const L=o=>typeof o==='string'?o:(o[S.lang]||o.en||o.nl||'');

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  LANGUAGE SWITCH
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function setLang(lang){
  S.lang=lang;
  document.querySelectorAll('.lang-btn').forEach(b=>b.classList.toggle('active',b.dataset.lang===lang));
  document.documentElement.lang=lang;
  applyUI(); renderBL(); renderVF(); upd(); updS();
}
function applyUI(){
  document.getElementById('ui-sub').textContent=t('sub');
  document.getElementById('btn-r').innerHTML=t('btnR');
  document.getElementById('btn-e').innerHTML=t('btnE');
  document.getElementById('ui-pt').textContent=t('pt');
  document.getElementById('lbl-pn').textContent=t('pn');
  document.getElementById('lbl-pr').textContent=t('pr');
  document.getElementById('lbl-pd').textContent=t('pd');
  document.getElementById('lbl-ps').textContent=t('ps');
  document.getElementById('lbl-fw').textContent=t('fw');
  document.getElementById('o-si').textContent=t('oSI');
  document.getElementById('o-io').textContent=t('oIO');
  document.getElementById('ui-st').textContent=t('st');
  document.getElementById('ui-sh').textContent=t('sh');
  document.getElementById('ui-et').textContent=t('et');
  document.getElementById('ui-eh').textContent=t('eh');
  document.getElementById('ui-pvt').textContent=t('pvt');
  document.getElementById('ui-sr').textContent=t('sr');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function init(){
  document.getElementById('proj-date').value=new Date().toISOString().split('T')[0];
  TB.forEach(b=>{if(b.mand)S.sel.add(b.id);S.vals[b.id]={};S.supVars[b.id]={};});
  applyUI();renderBL();renderVF();upd();updS();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  BLOCK LIST
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderBL(){
  let h='';
  CO.forEach(cat=>{
    const bs=TB.filter(b=>b.cat===cat);if(!bs.length)return;
    h+=`<div class="block-category"><div class="block-category-label">${CL[S.lang]?.[cat]||cat}</div>`;
    bs.forEach(b=>{
      const s=S.sel.has(b.id);
      h+=`<div class="bc ${s?'sel':''} ${b.mand?'mand':''}" onclick="tog('${b.id}')" id="c-${b.id}"><div class="bt"></div><div class="bi"><h4>${L(b.ti)}</h4><p>${L(b.ds)}</p></div><div class="bb">${b.mand?t('req'):t('opt')}</div></div>`;
    });
    h+='</div>';
  });
  document.getElementById('bl').innerHTML=h;
}
function tog(id){S.sel.has(id)?S.sel.delete(id):S.sel.add(id);document.getElementById('c-'+id).classList.toggle('sel');renderVF();upd();updS();}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  VARIABLE FORMS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderVF(){
  const c=document.getElementById('vf'),es=document.getElementById('es');
  const sel=TB.filter(b=>S.sel.has(b.id)&&b.vars.length>0);
  if(!sel.length){es.style.display='flex';c.innerHTML='';return;}
  es.style.display='none';
  let h='';
  sel.forEach(b=>{
    const sl=b.sl,sc=sl==='varies'?'v':'',slab=sl==='install_only'?t('io'):sl==='supply_install'?t('si'):sl==='varies'?t('sv'):'';
    h+=`<div class="vs"><div class="vsh"><h3>${L(b.ti)}</h3>${slab?`<span class="sb ${sc}">${slab}</span>`:''}</div><div class="vg">`;
    b.vars.forEach(v=>{
      const val=S.vals[b.id]?.[v.n]||'',us=typeof v.u==='object'?L(v.u):v.u,ll=L(v.l);
      const isSup=S.supVars[b.id]?.[v.n]||false;
      const supCls=isSup?'supplier-set':'';
      const supAct=isSup?'active':'';
      h+=`<div class="vf ${supCls}">`;
      h+=`<label><span class="sup-row"><span>${ll} ${us?`<span class="u">(${us})</span>`:''}</span><span class="sup-toggle ${supAct}" onclick="event.preventDefault();toggleSup('${b.id}','${v.n}')" title="${t('supFull')}"><span class="sup-check">${isSup?'âœ“':''}</span> ${t('supBtn')}</span></span></label>`;
      if(v.t==='select'){
        h+=`<select onchange="sv('${b.id}','${v.n}',this.value)" ${isSup?'disabled':''}><option value="">${t('sel')}</option>${v.opts.map(o=>`<option value="${o}"${val===o?' selected':''}>${o}</option>`).join('')}</select>`;
      }else{
        h+=`<input type="text" value="${isSup?'':val}" placeholder="${isSup?t('supFull'):(v.ph||'')}" oninput="sv('${b.id}','${v.n}',this.value)" ${isSup?'disabled':''}>`;
      }
      h+=`</div>`;
    });
    h+='</div></div>';
  });
  c.innerHTML=h;
}
function toggleSup(bid,vn){
  if(!S.supVars[bid])S.supVars[bid]={};
  S.supVars[bid][vn]=!S.supVars[bid][vn];
  if(S.supVars[bid][vn]){S.vals[bid][vn]='';}
  renderVF();upd();updS();
}
function sv(bid,vn,val){if(!S.vals[bid])S.vals[bid]={};S.vals[bid][vn]=val;upd();updS();}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  PREVIEW
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function upd(){
  const c=document.getElementById('pvb'),pc=document.getElementById('pvc');
  const sel=TB.filter(b=>S.sel.has(b.id));
  pc.textContent=sel.length+' '+t('bk');
  if(!sel.length){c.innerHTML=`<p style="color:#666;font-size:13px;text-align:center;margin-top:40px">${t('pve')}</p>`;return;}
  let h='';
  sel.forEach(b=>{
    let tx=L(b.tp);const vs=S.vals[b.id]||{};
    tx=tx.replace(/\{(\w+)\}/g,(m,vn)=>{
      const isSup=S.supVars[b.id]?.[vn]||false;
      if(isSup) return`<span class="vs-tag">[${t('supFull')}]</span>`;
      const val=vs[vn];if(val)return`<span class="vh">${val}</span>`;
      const vd=b.vars.find(v=>v.n===vn);return`<span class="ve">[${vd?L(vd.l):vn}]</span>`;
    });
    h+=`<div class="pbl"><div class="pbt">${b.id} â€” ${L(b.ti)}</div><div class="ptx">${tx}</div></div>`;
  });
  c.innerHTML=h;
}
function updS(){
  document.getElementById('st-b').textContent=S.sel.size+' '+t('bsel');
  let f=0,tt=0,sp=0;
  TB.filter(b=>S.sel.has(b.id)).forEach(b=>{b.vars.forEach(v=>{tt++;if(S.supVars[b.id]?.[v.n])sp++;else if(S.vals[b.id]?.[v.n])f++;});});
  document.getElementById('st-v').textContent=`${f}/${tt} ${t('vfil')}` + (sp ? ` Â· ${sp}Ã— ${t('supBtn')}` : '');
}
function resetAll(){S.sel.clear();TB.forEach(b=>{if(b.mand)S.sel.add(b.id);S.vals[b.id]={};S.supVars[b.id]={};});renderBL();renderVF();upd();updS();}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  WORD EXPORT (in active language)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function exportToWord(){
  try {
    if (typeof docx === 'undefined') { alert('docx.js library not loaded. Check your internet connection.'); return; }
    if (typeof saveAs === 'undefined') { alert('FileSaver.js library not loaded. Check your internet connection.'); return; }

    const Paragraph = docx.Paragraph;
    const TextRun = docx.TextRun;
    const Table = docx.Table;
    const TableRow = docx.TableRow;
    const TableCell = docx.TableCell;
    const BorderStyle = docx.BorderStyle;
    const WidthType = docx.WidthType;
    const TabStopType = docx.TabStopType;

    const pn = document.getElementById('proj-name').value || t('pn');
    const pr = document.getElementById('proj-ref').value || 'STP00000';
    const pd = document.getElementById('proj-date').value || new Date().toISOString().split('T')[0];
    const ps = document.getElementById('proj-supplier').value || t('ps');
    const dl = S.lang==='de' ? 'de-DE' : S.lang==='en' ? 'en-GB' : 'nl-NL';
    const ds = new Date(pd).toLocaleDateString(dl, {day:'numeric', month:'long', year:'numeric'});
    const OC = 'F94816', DC = '22293B';

    const sel = TB.filter(b => S.sel.has(b.id));
    const children = [];

    // Title
    children.push(new Paragraph({ spacing:{before:600,after:200}, children:[new TextRun({text: t('dT') + ' â€” ' + pn, bold:true, size:36, color:OC, font:'Arial'})] }));
    children.push(new Paragraph({ border:{bottom:{style:BorderStyle.SINGLE, size:6, color:OC, space:1}}, spacing:{after:200}, children:[] }));

    // Meta table
    const bd = {style:BorderStyle.SINGLE, size:1, color:'CCCCCC'};
    const bds = {top:bd, bottom:bd, left:bd, right:bd};
    const mg = {top:60, bottom:60, left:100, right:100};

    function makeCell(txt, bold) {
      return new TableCell({
        borders: bds,
        margins: mg,
        children: [new Paragraph({children:[new TextRun({text:txt, bold:!!bold, size:18, font:'Arial'})]})]
      });
    }

    children.push(new Table({
      width: {size:9026, type:WidthType.DXA},
      rows: [
        new TableRow({children:[makeCell(t('dDt'),true), makeCell(t('dRf'),true), makeCell(t('dPj'),true), makeCell(t('dSu'),true)]}),
        new TableRow({children:[makeCell(ds), makeCell(pr), makeCell(pn), makeCell(ps)]}),
      ]
    }));

    children.push(new Paragraph({spacing:{after:200}, children:[]}));
    children.push(new Paragraph({spacing:{after:200}, children:[new TextRun({text:t('dS'), size:20, font:'Arial'})]}));
    children.push(new Paragraph({spacing:{after:200}, children:[new TextRun({text:t('dI'), size:20, font:'Arial'})]}));

    // Text blocks grouped by category
    let curCat = '';
    sel.forEach(b => {
      if (b.cat !== curCat) {
        curCat = b.cat;
        children.push(new Paragraph({spacing:{before:300}, children:[]}));
        const catTitle = (CL[S.lang]?.[curCat] || curCat).replace(/^.+?\s/, '');
        children.push(new Paragraph({spacing:{after:100}, children:[new TextRun({text:catTitle, bold:true, size:24, color:OC, font:'Arial'})]}));
        children.push(new Paragraph({border:{bottom:{style:BorderStyle.SINGLE, size:2, color:OC, space:1}}, spacing:{after:160}, children:[]}));
      }
      children.push(new Paragraph({spacing:{before:160, after:80}, children:[new TextRun({text:L(b.ti), bold:true, size:20, color:DC, font:'Arial'})]}));

      let txt = L(b.tp);
      const vs = S.vals[b.id] || {};
      const sup = S.supVars[b.id] || {};
      txt = txt.replace(/\{(\w+)\}/g, (m, vn) => {
        if (sup[vn]) return '[' + t('supFull') + ']';
        return vs[vn] || '[' + vn + ']';
      });
      txt.split('\n').forEach(line => {
        const ln = line.trim();
        if (!ln) return;
        children.push(new Paragraph({
          spacing:{after:40},
          indent: (ln.startsWith('-') || ln.startsWith('â€¢')) ? {left:360} : {},
          children:[new TextRun({text:ln, size:20, font:'Arial'})]
        }));
      });
    });

    // Closing
    children.push(new Paragraph({spacing:{before:400}, children:[]}));
    children.push(new Paragraph({spacing:{after:100}, children:[new TextRun({text:t('dC'), size:20, font:'Arial'})]}));
    children.push(new Paragraph({spacing:{after:200}, children:[new TextRun({text:t('dG'), size:20, font:'Arial'})]}));
    children.push(new Paragraph({children:[new TextRun({text:'STM Group', bold:true, size:20, color:DC, font:'Arial'})]}));

    // Build document
    const doc = new docx.Document({
      sections: [{
        properties: {
          page: {
            size: {width:11906, height:16838},
            margin: {top:1440, right:1200, bottom:1440, left:1200}
          }
        },
        headers: {
          default: new docx.Header({
            children: [new Paragraph({
              border:{bottom:{style:BorderStyle.SINGLE, size:4, color:OC, space:1}},
              tabStops:[{type:TabStopType.RIGHT, position:9506}],
              children:[
                new TextRun({text:'STM GROUP', bold:true, size:16, color:DC, font:'Arial'}),
                new TextRun({text:'\tRef: '+pr, size:16, color:'999999', font:'Arial'})
              ]
            })]
          })
        },
        footers: {
          default: new docx.Footer({
            children: [new Paragraph({
              border:{top:{style:BorderStyle.SINGLE, size:2, color:'CCCCCC', space:1}},
              tabStops:[{type:TabStopType.RIGHT, position:9506}],
              children:[
                new TextRun({text:'STMgroup.com', size:14, color:'999999', font:'Arial'}),
                new TextRun({text:"\tLet's forge the future together", size:14, color:OC, font:'Arial', italics:true})
              ]
            })]
          })
        },
        children: children
      }]
    });

    const blob = await docx.Packer.toBlob(doc);
    saveAs(blob, 'RFQ_' + pr + '_' + pn.replace(/\s+/g,'_') + '_' + S.lang.toUpperCase() + '.docx');

  } catch(err) {
    console.error('Export error:', err);
    alert('Export failed: ' + err.message + '\n\nCheck browser console for details.');
  }
}

init();
</script>
</body>
</html>
